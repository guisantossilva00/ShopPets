<!-- sldsValidatorIgnore -->
<template >
    <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-text-body_regular"> 
        <thead>
            <tr class="slds-line-height_reset">
                <th class="" scope="col">
                    <div style="text-align: left">
                        <Span style="font-size: 18px ">Matriz de Volume por CondiÃ§Ã£o de Pagamento</Span>  
                    </div>  
                </th>
                <td>
                    <div class="slds-truncate" style="text-align: right; padding: 5px">
                        <button onclick={save} class="slds-button slds-button_brand">Salvar</button>
                        <button onclick={cancelButton} class="slds-button slds-button_neutral" style="margin-left: 10px">Cancelar</button>
                    </div>
                </td>
            </tr>
        </thead>
    </table>    
    <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered slds-text-body_regular"> 
        <thead>
            <tr class="slds-line-height_reset">
                
                <td class="" scope="col">
                    <br></br>
                    <div style="width: 100%">
                        <h2 style="padding-bottom: 2px;"><b>Produto: </b></h2>  
                        <select onchange={productSelected} class="slds-select" name="optionSelect">
                                <option value="Nenhum">Nenhum</option>
                                <template for:each={productsByName.data} for:item="product">
                                    <option key={product.Id} value={product.Id}>{product.Name}</option>
                                </template>
                        </select>
  

                        <br></br>

                        <h2 style="padding-bottom: 2px;"><b>Copiar de: </b></h2>  
                        <select onchange={cloneSelected} class="slds-select" name="optionSelectClone">
                            <option value="Nenhum">Nenhum</option>
                            <template for:each={productsByName.data} for:item="product">
                                <option key={product.Id} value={product.Id}>{product.Name}</option>
                            </template>
                        </select>
                    </div>
                    <div style="text-align: right; padding: 5px; margin-top: 5px">
                        <button onclick={clone} class="slds-button slds-button_outline-brand">Copiar</button>
                    </div>
                </td>
            </tr>

        </thead>
    </table>    

    <div style="text-align: right; background-color: whitesmoke" class = "slds-text-body_regular">

            
        <div style="padding: 5px">
            <button onclick={openModal} title="Adicionar coluna" id="openModalRow" class="slds-button slds-button_neutral" style="margin-top: 10px"><Small>âž•</Small></button>
            <button onclick={removeRow} title="Remover coluna" id="removeRowOnClick" class="slds-button slds-button_neutral" style="margin-top: 10px"><Small>âž–</Small></button>
        </div>
        <template if:true={isModalOpen}>
            <!-- Modal/Popup Box LWC starts here -->
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <!-- Modal/Popup Box LWC header here -->
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                            <lightning-icon icon-name="utility:close"
                                alternative-text="close"
                                variant="inverse"
                                size="small" ></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Adicionar nova coluna</h2>
                    </header>
                    <!-- Modal/Popup Box LWC body starts here -->
                    <div style="text-align: left" class="slds-modal__content slds-var-p-around_medium" id="modal-content-id-1">
                            <Span>Selecione o tipo da condiÃ§Ã£o de pagamento</Span>
                            <select onchange={selectedModal} class="slds-select" name="optionSelect">
                                    <option value= "Nenhum">Nenhum</option>
                                    <template for:each={conditionType} for:item="optionType">
                                        <option key = {optionType} value= {optionType}>{optionType}</option>
                                    </template>
                            </select> 
                    </div>
                    <!-- M                          dal/Popup Box LWC footer starts here -->
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick={closeModal} title="Cancelar">Cancelar</button>
                        <button class="slds-button slds-button_brand" onclick={addRow} title="OK">OK</button>
                    </footer>
                </div>
            </section>  
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
        
        <div class="slds-scrollable slds-text-body_regular" style="height:20rem;width:100%; background-color:whitesmoke">


            <div class="slds-text-longform" style="width:400%;">
               
                <table id = "tabelaDeValores" class= "slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered" style="box-sizing: border-box; width:auto">
                        <!--lines-->
                            <template iterator:it={records}>
                                <tr key= {it.value}>
                                    <td>
                                        <template if:true={it.first}><span>Vol. Inicial</span></template>
                                        <div class="slds-form-element">
                                            
                                            <div style="margin-top: 22px" class="slds-form-element__control">
                                                <lightning-input id={it.index} title={it.index} onchange={assignFields} name="initial" type="number" value={it.value.InitialVolumeNmb__c} min="1" max="999999" required=""></lightning-input>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <template if:true={it.first}><span>Vol. Final</span></template>
                                        <div class="slds-form-element">
                                            <div style="margin-top: 22px" class="slds-form-element__control">
                                                <lightning-input id={it.index} onchange={assignFields} name="final" min="1" max="999999" value={it.value.FinalVolumeNmb__c} type="number" required=""></lightning-input> 
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <template if:true={it.first}><span style="margin-top: 10px">A vista DDF - 0010</span></template>
    
                                        <fieldset class="slds-form-element">
                                            
                                            <div class="slds-form-element__control" style="text-align: center; margin-top: 8px">
    
                                                <div style="text-align: center;" class ="slds-grid slds-gutters">
                                                    <div  class ="slds-col">
                                                        <lightning-input id={it.index} onchange={assignFields} name="bookCheckbox" label="ðŸ“”" title="Definir preÃ§o final e cÃ¡lculos posteriores" type="checkbox" value={it.value.ListPriceBln__c} checked={it.value.ListPriceBln__c} enabled></lightning-input>
                                                    </div>
                                                    <div class="slds-col">
                                                        <lightning-input id={it.index} onchange={assignFields} name="cartCheckbox" label="ðŸ›’" title="Definir como preÃ§o mÃ­nimo de venda" type="checkbox" value={it.value.LowPriceBln__c} checked={it.value.LowPriceBln__c} enabled></lightning-input>
                                                    </div>
                                                </div>
    
                                                <div class="slds-form-element__control">
                                                    <lightning-input placeholder ="0,00" step=".01" title={it.index} id={it.index} name="mult" onchange={assignFields} type="number" min= -9,9 max = 9,9 value = {it.value.MultiplierPriceNmb__c}></lightning-input> 
                                                </div>
                                            </div>
    
                                        </fieldset>
                                    </td>
                                        <template for:each={rows} for:item="row" for:index="indexNewRow">
                                            
                                            <td key={row.Name}>
                                                <template if:true={it.first}>

                                                    <div style="padding: 1px; margin-top: 2px"> 
                                                        <select data-select="data-select" onchange={assignRowsFields} id={row.name} class="slds-select" name={indexNewRow}>
                                                            <option value= {row.Name}>{row.Name}</option>
                                                            <template for:each={conditionType} for:item="optionType">
                                                                <option  key = {optionType} value= {optionType}>{optionType}</option>
                                                            </template>
                                                        </select>
                                                    </div>
                                                    <div style="margin-top: 7.7px" >
                                                        <lightning-input data-row="data-row" placeholder ="0,00"  title={it.index} step=".01" onchange={assignRowsValues} name={indexNewRow} type="number" min= -9,9 max = 9,9></lightning-input>
                                                    </div>
                                                </template>
                                                <template if:false={it.first}>
                                                    <div style="margin-top: 27px;">
                                                        <lightning-input data-row="data-row" placeholder ="0,00" step=".01" title={it.index} onchange={assignRowsValues} name={indexNewRow} type="number" min= -9,9 max = 9,9></lightning-input>
                                                    </div>                 
                                                </template>
                                            </td>
                                        </template>
                                </tr>
                        </template> 
                </table> 
            </div>
        </div>
    </div>
    <div style="text-align: left; background-color:whitesmoke" class = "slds-text-body_regular">
            <div style="padding: 5px">
                <button onclick={addLine} title="Adicionar linha" id="addLine" class="slds-button slds-button_neutral"><Small>âž•</Small></button>
                <button onclick={removeLine} title="Remover linha" id="removeLine" class="slds-button slds-button_neutral"><Small>âž–</Small></button>    
            </div>
            
    </div>
</template>