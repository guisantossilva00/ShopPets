<!-- sldsValidatorIgnore -->
<!-- sldsValidatorIgnore -->
<template>
    <div style="font-size: 18px; padding: 10px" class="background-white">
        <span>Ação de vendas</span>
    </div>
    <div class = "background-white center-form">
        <div class="slds-tabs_default">
            
            <ul class="slds-tabs_default__nav" role="tablist">
                <li onclick={showDetailTab} class={detailStyle} title="Detalhes" role="presentation">
                <a class="slds-tabs_default__link" role="tab" tabindex={tabDetailInUse} aria-selected={detailOn} aria-controls="tab-default-1" id="tab-default-1__item">Detalhes</a>
                </li>
                <li onclick={showClientTab} class={clientStyle} title="Clientes" role="presentation">
                <a class="slds-tabs_default__link" role="tab" tabindex={tabClientInUse} aria-selected={clientOn} aria-controls="tab-default-2" id="tab-default-2__item">Clientes</a>
                </li>
                <li onclick={showProductTab} class={productStyle} title="Produtos" role="presentation">
                <a class="slds-tabs_default__link" role="tab" tabindex={tabProductInUse} aria-selected={productOn} aria-controls="tab-default-3" id="tab-default-3__item">Produtos</a>
                </li>
            </ul>
        </div>
        <div>
            <div class = "default-padding" style="text-align: right;">
                <button onclick={nextTab} name="Save" class="slds-button slds-button_brand" title="Salvar">Salvar</button>
                <template if:false={detailOn}>
                    <button onclick={previousTab}  name="Previous" class="slds-button slds-button_neutral" title="Voltar">Voltar</button>
                </template>
                <template if:true={detailOn}>
                    <button class="slds-button slds-button_neutral" disabled>Voltar</button>
                </template>
            </div>
            <div class = "default-padding" style="text-align: left">
                <template if:true={detailOn}>
                    <article class="card-center">
                        <div class="small-distance">
                            <div>
                                <lightning-input onchange={setSalesActionName} placeholder="Digite o nome da ação de vendas." required="" label="Nome da ação:" value={salesAction.Name} title="Nome da ação de vendas" pattern="(.|\s)*\S(.|\s)*" message-when-pattern-mismatch="Digite um nome para ação válido"></lightning-input>
                            </div>
                        </div> 

                        <abbr title="obrigatório" class="slds-required">*</abbr>
                        <span class="slds-form-element__label slds-no-flex">Centro de distribuição:</span>
                        <div class="slds-select_container small-distance"> 
                            <select onchange={setSupplierCenter} class="slds-select" title="Centro de distribuição">
                                <option data-supp="data-supp" value="">Nenhum</option>
                                <template for:each={supplierCenter} for:item="supplier">
                                    <option data-supp="data-supp"  key={supplier.Id} value={supplier.Id}>{supplier.Name}</option>
                                </template>
                            </select>
                        </div>

                        <abbr title="obrigatório" class="slds-required">*</abbr>
                        <span class="slds-form-element__label slds-no-flex">Equipe de Vendas:</span>
                        <div class="slds-select_container small-distance"> 
                            <select onchange={setRepresentative} class="slds-select" title="Equipe de Vendas">
                                <option data-rep="data-rep" value="">Nenhum</option>
                                <template for:each={representative} for:item="record">
                                    <option data-rep="data-rep" key={record.Id} value={record.Id}>{record.Name}</option>
                                </template>
                            </select>
                        </div>
            
                        <div style="text-align: center"> 
                            <div class="inline">
                                <lightning-input min={today} value={salesAction.StartDateDte__c} required="" onchange={setStartDate} class="middle-center" placeholder="DD/MM/AAAA" date-style="short" label="Data de início" title="Data de início" type="date"></lightning-input>
                            </div>
                            <div class="inline"> 
                                <lightning-input min={today} value={salesAction.EndDateDte__c} required="" onchange={setEndDate}  class="middle-center" placeholder="DD/MM/AAAA" date-style="short" label="Data de fim" title="Data de fim" type="date"></lightning-input>
                            </div>
                        </div>
            
                        <div style="position: sticky;">
                            <lightning-textarea value={salesAction.ObservationTxt__c} onchange={setObservation} label="Observação:" maxlength=255 class = "inputAdjust" type="text" placeholder="Digite a observação da ação de vendas."></lightning-textarea>
                        </div>
                    </article>
                </template>
                <template if:true={clientOn}>
                    <article class="card-left">
                        <div class = "default-padding" style="text-align: left">
                            <span class="slds-form-element__label slds-no-flex">Cliente:</span>
                            <div class="slds-select_container small-distance"> 
                                <select onchange={selectedClient} class="slds-select" title="account">
                                    <option data-client="data-client-default" value="Todos">Todos</option>
                                    <template for:each={clients} for:item="account">
                                        <option data-client="data-client" key={account.Id} value={account.Id}>{account.Name}</option>
                                    </template>
                                </select>
                            </div>
                        </div>
                    </article>
                    <div class = "default-padding" style="text-align: center; margin-bottom: 10px;">
                        <button onclick={addClient} class="slds-button slds-button_neutral" title="Adicionar">Adicionar</button>
                        <button onclick={removeClient} class="slds-button slds-button_neutral" title="Remover">Remover</button>
                    </div>
                    <div class = "default-padding" style="text-align: left;">
                        <template if:true={hasClientsAddeds}>

                            <table class="default-padding slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered" >
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th scope="col">
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Código SAP">Código SAP</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="Cliente">Cliente</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={clientsAddeds} for:item="account">
                                        <tr key={account.Id} class="slds-line-height_reset">
                                            <td class="table-checkbox"  scope="col">
                                                <lightning-input onclick={markToRemove} id={account.Id} value="false" name={account.Id} title="Selecionar" type="checkbox" enabled></lightning-input>
                                            </td>
                                            <td class="" scope="col">
                                                {account.SAPCodeTxt__c}
                                            </td>
                                            <td class="" scope="col">
                                                {account.Name}
                                            </td>
                                        </tr>                                   
                                    </template>
                                </tbody>
                            </table>
                        </template>
                        <template if:false={hasClientsAddeds}>
                            <span class="message">Todos os clientes da equipe de vendas serão adicionados automaticamente caso não haja seleção.</span>
                        </template>
                    </div>
                </template>
                <template if:true={productOn}>    
                    <div>
                        <span class="slds-form-element__label slds-no-flex">Selecione o produto:</span>
                        <div class="slds-select_container small-distance card-left"> 
                            <select onchange={productSelectedModal} class="slds-select" title="Produtos">
                                <option value="">Nenhum</option>
                                <template for:each={products} for:item="product">
                                    <option key={product.Id} value={product.Id}>{product.Name}</option>
                                </template>
                            </select> 
                        </div>
                        <div style="text-align: center; margin-bottom: 10px;">
                            <button onclick={addProduct} class="slds-button slds-button_neutral" title="Adicionar">Adicionar</button>
                        </div>
                    </div>    
                    <template if:true={hasProducts}>
                        <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered" >
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th scope="col">
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="Produto">Produto</div>
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="Volume inicial">Volume inicial</div>
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="Volume final">Volume final</div>
                                    </th>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="Desconto">Desconto (%)</div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={salesActionItens} for:item="salesActionItem" for:index="index">
                                    <tr key={salesActionItem.salesActionItem} class="slds-line-height_reset">
                                        <td class="table-checkbox"  scope="col">
                                            <lightning-input onchange={productCheckbox} name={index} value="false" title="Selecionar" type="checkbox" enabled></lightning-input>
                                        </td>
                                        
                                        <td class="" scope="col">
                                            <span>{salesActionItem.Name}</span>
                                        </td>

                                        <td class="" scope="col">
                                            <lightning-input onchange={setInitialVolume} id={index} required="" name={index} value={salesActionItem.InitialVolumeNmb__c} class="middle-center" maxlength=4 title="Quantidade" placeholder="1" min=1 max=9999 pattern="^[1-9]([0-9]*)" format-style="number"></lightning-input>
                                        </td>

                                        <td class="" scope="col">
                                            <lightning-input onchange={setEndVolume} id={index} required="" name={index}  value={salesActionItem.EndVolumeNmb__c} class="middle-center" maxlength=4 title="Quantidade" placeholder="9999" min=1 max=9999 pattern="^[1-9]([0-9]*)" format-style="number"></lightning-input>
                                        </td>

                                        <td class="" scope="col">
                                            <lightning-input id={index} onchange={setDiscount} required="" name={index} value={salesActionItem.DiscountNmb__c} title="Desconto (%)" placeholder="0" max-length=2 min=1 max=99 type="number"></lightning-input>
                                        </td>
                                    </tr>                                   
                                </template>
                            </tbody>
                        </table>
                    </template>
                    <template if:false={hasProducts}>
                        <span class="message">Nenhum produto existente.</span>
                    </template>
                </template>
            </div>
        </div>
    </div>
</template>